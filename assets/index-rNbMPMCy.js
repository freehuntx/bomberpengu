var ne=Object.defineProperty;var V=c=>{throw TypeError(c)};var re=(c,i,e)=>i in c?ne(c,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[i]=e;var a=(c,i,e)=>re(c,typeof i!="symbol"?i+"":i,e),W=(c,i,e)=>i.has(c)||V("Cannot "+e);var m=(c,i,e)=>(W(c,i,"read from private field"),e?e.call(c):i.get(c)),O=(c,i,e)=>i.has(c)?V("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(c):i.set(c,e),S=(c,i,e,l)=>(W(c,i,"write to private field"),l?l.call(c,e):i.set(c,e),e);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const n of f)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function e(f){const n={};return f.integrity&&(n.integrity=f.integrity),f.referrerPolicy&&(n.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?n.credentials="include":f.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(f){if(f.ep)return;f.ep=!0;const n=e(f);fetch(f.href,n)}})();var $={exports:{}},X;function se(){if(X)return $.exports;X=1;var c=typeof Reflect=="object"?Reflect:null,i=c&&typeof c.apply=="function"?c.apply:function(t,s,o){return Function.prototype.apply.call(t,s,o)},e;c&&typeof c.ownKeys=="function"?e=c.ownKeys:Object.getOwnPropertySymbols?e=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:e=function(t){return Object.getOwnPropertyNames(t)};function l(r){console&&console.warn&&console.warn(r)}var f=Number.isNaN||function(t){return t!==t};function n(){n.init.call(this)}$.exports=n,$.exports.once=H,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var p=10;function C(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(r){if(typeof r!="number"||r<0||f(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");p=r}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||f(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function h(r){return r._maxListeners===void 0?n.defaultMaxListeners:r._maxListeners}n.prototype.getMaxListeners=function(){return h(this)},n.prototype.emit=function(t){for(var s=[],o=1;o<arguments.length;o++)s.push(arguments[o]);var u=t==="error",v=this._events;if(v!==void 0)u=u&&v.error===void 0;else if(!u)return!1;if(u){var d;if(s.length>0&&(d=s[0]),d instanceof Error)throw d;var L=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw L.context=d,L}var M=v[t];if(M===void 0)return!1;if(typeof M=="function")i(M,this,s);else for(var J=M.length,te=q(M,J),o=0;o<J;++o)i(te[o],this,s);return!0};function E(r,t,s,o){var u,v,d;if(C(s),v=r._events,v===void 0?(v=r._events=Object.create(null),r._eventsCount=0):(v.newListener!==void 0&&(r.emit("newListener",t,s.listener?s.listener:s),v=r._events),d=v[t]),d===void 0)d=v[t]=s,++r._eventsCount;else if(typeof d=="function"?d=v[t]=o?[s,d]:[d,s]:o?d.unshift(s):d.push(s),u=h(r),u>0&&d.length>u&&!d.warned){d.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=r,L.type=t,L.count=d.length,l(L)}return r}n.prototype.addListener=function(t,s){return E(this,t,s,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(t,s){return E(this,t,s,!0)};function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(r,t,s){var o={fired:!1,wrapFn:void 0,target:r,type:t,listener:s},u=N.bind(o);return u.listener=s,o.wrapFn=u,u}n.prototype.once=function(t,s){return C(s),this.on(t,y(this,t,s)),this},n.prototype.prependOnceListener=function(t,s){return C(s),this.prependListener(t,y(this,t,s)),this},n.prototype.removeListener=function(t,s){var o,u,v,d,L;if(C(s),u=this._events,u===void 0)return this;if(o=u[t],o===void 0)return this;if(o===s||o.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete u[t],u.removeListener&&this.emit("removeListener",t,o.listener||s));else if(typeof o!="function"){for(v=-1,d=o.length-1;d>=0;d--)if(o[d]===s||o[d].listener===s){L=o[d].listener,v=d;break}if(v<0)return this;v===0?o.shift():Z(o,v),o.length===1&&(u[t]=o[0]),u.removeListener!==void 0&&this.emit("removeListener",t,L||s)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(t){var s,o,u;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[t]),this;if(arguments.length===0){var v=Object.keys(o),d;for(u=0;u<v.length;++u)d=v[u],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=o[t],typeof s=="function")this.removeListener(t,s);else if(s!==void 0)for(u=s.length-1;u>=0;u--)this.removeListener(t,s[u]);return this};function g(r,t,s){var o=r._events;if(o===void 0)return[];var u=o[t];return u===void 0?[]:typeof u=="function"?s?[u.listener||u]:[u]:s?k(u):q(u,u.length)}n.prototype.listeners=function(t){return g(this,t,!0)},n.prototype.rawListeners=function(t){return g(this,t,!1)},n.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):U.call(r,t)},n.prototype.listenerCount=U;function U(r){var t=this._events;if(t!==void 0){var s=t[r];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};function q(r,t){for(var s=new Array(t),o=0;o<t;++o)s[o]=r[o];return s}function Z(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function k(r){for(var t=new Array(r.length),s=0;s<t.length;++s)t[s]=r[s].listener||r[s];return t}function H(r,t){return new Promise(function(s,o){function u(d){r.removeListener(t,v),o(d)}function v(){typeof r.removeListener=="function"&&r.removeListener("error",u),s([].slice.call(arguments))}B(r,t,v,{once:!0}),t!=="error"&&ee(r,u,{once:!0})})}function ee(r,t,s){typeof r.on=="function"&&B(r,"error",t,s)}function B(r,t,s,o){if(typeof r.on=="function")o.once?r.once(t,s):r.on(t,s);else if(typeof r.addEventListener=="function")r.addEventListener(t,function u(v){o.once&&r.removeEventListener(t,u),s(v)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}return $.exports}var K=se();const w=class w extends K.EventEmitter{constructor(e,l=[]){super();a(this,"CONNECTING",0);a(this,"OPEN",1);a(this,"CLOSING",2);a(this,"CLOSED",3);a(this,"bufferedAmount",0);a(this,"binaryType","arraybuffer");a(this,"protocol","");a(this,"readyState",w.CONNECTING);a(this,"url","");a(this,"extensions",{});a(this,"isPaused",!1);a(this,"_ping",0);a(this,"_events",new EventTarget);a(this,"onopen",null);a(this,"onmessage",null);a(this,"onerror",null);a(this,"onclose",null);this.url=typeof e=="string"?e:e.href,this.protocol=typeof l=="string"?l:l.join(","),this.on("open",()=>{var n;this.readyState=w.OPEN;const f=new Event("open");(n=this.onopen)==null||n.call(this,f),this.dispatchEvent(f)}),this.on("message",f=>{var p;const n=new MessageEvent("message",{data:f});(p=this.onmessage)==null||p.call(this,n),this.dispatchEvent(n)}),this.on("close",(f,n)=>{var C;this.readyState=w.CLOSED;const p=new CloseEvent("close",{code:f,reason:n});(C=this.onclose)==null||C.call(this,p),this.dispatchEvent(p)}),this.on("error",f=>{var p;const n=new ErrorEvent("error",{error:f});(p=this.onerror)==null||p.call(this,n),this.dispatchEvent(n)})}setPing(e){this._ping=e<0?0:e}send(e){this.binaryType==="arraybuffer"&&(typeof e=="string"?e=new TextEncoder().encode(e).buffer:ArrayBuffer.isView(e)&&(e=e.buffer)),setTimeout(()=>{this.emit("send",e)},this._ping/2)}pause(){if(this.readyState!==w.CONNECTING&&this.readyState!==w.CLOSED)throw new Error("pause not implemented")}ping(e,l,f){throw new Error("ping not implemented")}pong(e,l,f){throw new Error("pong not implemented")}resume(){if(this.readyState!==w.CONNECTING&&this.readyState!==w.CLOSED)throw new Error("resume not implemented")}close(e=1e3,l=""){this.readyState===w.OPEN&&(this.readyState=w.CLOSING),this.readyState!=w.CLOSED&&(this.readyState=w.CLOSED,setTimeout(()=>{this.emit("close",e,l)},this._ping/2))}terminate(){throw new Error("terminate not implemented")}addEventListener(e,l){this._events.addEventListener(e,l)}removeEventListener(e,l){this._events.removeEventListener(e,l)}dispatchEvent(e){return this._events.dispatchEvent(e)}};a(w,"CONNECTING",0),a(w,"OPEN",1),a(w,"CLOSING",2),a(w,"CLOSED",3);let F=w;class ie extends K.EventEmitter{constructor(e={}){super();a(this,"_host");a(this,"_port");a(this,"_ping");a(this,"_url");this._ping=e.ping??0,this._host=e.host??"0.0.0.0",this._port=e.port??(location.protocol==="https:"?443:80),this._url=e.url,this._hookWebSocket()}get ping(){return this._ping}address(){var e;return{family:((e=this._host)==null?void 0:e.indexOf(":"))!==-1?"IPv6":"IPv4",address:this._host,port:this._port}}_hookWebSocket(){const e=this,l=window.WebSocket,n=class n extends EventTarget{constructor(h,E=[]){super();a(this,"CONNECTING",0);a(this,"OPEN",1);a(this,"CLOSING",2);a(this,"CLOSED",3);a(this,"_binaryType","blob");a(this,"bufferedAmount",0);a(this,"protocol","");a(this,"readyState",0);a(this,"url","");a(this,"extensions","");a(this,"wsClient",null);a(this,"onopen",null);a(this,"onmessage",null);a(this,"onerror",null);a(this,"onclose",null);this.url=typeof h=="string"?h:h.href;let N=!1;if(e._url)N=new RegExp(e._url.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")).test(this.url);else{const y=e.address();N=this.url.indexOf(`://${y.address}:${y.port}`)!==-1}if(!N)return new l(h,E);this.readyState=n.CONNECTING,this.protocol=typeof E=="string"?E:E.join(","),this.wsClient=new F(h,E),this.wsClient.on("open",()=>{e.emit("connection",this.wsClient)}),this.wsClient.on("send",y=>{const g=new MessageEvent("message",{data:y});this.dispatchEvent(g)}),this.addEventListener("open",y=>{var g;(g=this.onopen)==null||g.call(this,y),setTimeout(()=>{this.wsClient.emit("open")},e.ping/2)}),this.addEventListener("message",y=>{var g;(g=this.onmessage)==null||g.call(this,y)}),this.addEventListener("close",y=>{var g;(g=this.onclose)==null||g.call(this,y),setTimeout(()=>{this.wsClient.emit("close")},e.ping/2)}),this.addEventListener("error",y=>{var g;(g=this.onerror)==null||g.call(this,y)}),setTimeout(()=>{this.readyState=n.OPEN,this.dispatchEvent(new Event("open"))},100)}get binaryType(){return this._binaryType}set binaryType(h){this._binaryType=h,h==="arraybuffer"&&(this.wsClient.binaryType=h)}close(){if(this.readyState===n.CLOSING||this.readyState===n.CLOSED)throw new Error("WebSocket is not open");this.readyState=n.CLOSING,this.readyState=n.CLOSED,this.dispatchEvent(new Event("close"))}send(h){if(this.readyState!==n.OPEN)throw new Error("WebSocket is not open");if(ArrayBuffer.isView(h)){const E=h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength);h=Reflect.construct(h.constructor,[E])}else h instanceof ArrayBuffer&&(h=h.slice(0));this.binaryType==="arraybuffer"&&(typeof h=="string"?h=new TextEncoder().encode(h).buffer:ArrayBuffer.isView(h)&&(h=h.buffer)),setTimeout(()=>{this.wsClient.emit("message",h)},e.ping/2)}};a(n,"CONNECTING",0),a(n,"OPEN",1),a(n,"CLOSING",2),a(n,"CLOSED",3);let f=n;window.WebSocket=f}}class oe{constructor(i){var n;const l=window.RufflePlayer.newest().createPlayer();i.targetElement.appendChild(l);const f={autoplay:"on",unmuteOverlay:"hidden",preloader:!1,splashScreen:!1,logLevel:"error",...i.ruffle,url:i.swfUrl,parameters:{...(n=i.ruffle)==null?void 0:n.parameters,...i.swfParameters},socketProxy:[]};for(const p of i.proxies||[])f.socketProxy.push({host:p.host,port:p.port,proxyUrl:`wss://${p.host}:${p.port}`}),new ie({host:p.host,port:p.port}).on("connection",h=>{var E;(E=p.onConnect)==null||E.call(p,h),h.on("message",N=>{var y;(y=p.onMessage)==null||y.call(p,h,N)}),h.on("close",(N,y)=>{var g;(g=p.onDisconnect)==null||g.call(p,h,N,y)})});console.log(f),l.load(f)}}class Q{constructor(){a(this,"emitter",new K.EventEmitter)}emit(i,...e){this.emitter.emit(i,...e)}on(i,e){this.emitter.on(i,e)}off(i,e){this.emitter.off(i,e)}}function Y(c){return(...i)=>new Promise((e,l)=>{c(...i,e,l)})}var A,b,x,P;class fe extends Q{constructor(e,l,f){super();O(this,A);O(this,b);O(this,x);O(this,P);S(this,A,e),S(this,x,l),S(this,P,f)}get id(){return m(this,x)}get roomType(){return m(this,P)}async sendEvent(e,...l){var f;(f=m(this,b))==null||f.send("event",JSON.stringify([e,...l]))}async sendXml(e){var l;(l=m(this,b))==null||l.send("xml",e)}async join(e={}){S(this,b,await Y(m(this,A).client.multiplayer.createJoinRoom)(m(this,x),m(this,P),!1,e.roomData||null,e.joinData||null)),m(this,b).addMessageCallback("event",l=>{const f=JSON.parse(l.getString(0));this.emit("event",...f)}),m(this,b).addMessageCallback("xml",l=>{this.emit("xml",l.getString(0))}),m(this,b).addDisconnectCallback(()=>{m(this,b)&&(S(this,b,null),this.emit("left"))}),this.emit("joined")}}A=new WeakMap,b=new WeakMap,x=new WeakMap,P=new WeakMap;var D,_,G,R,j;class ae extends Q{constructor(e,l=!1){super();O(this,D);O(this,_);O(this,G,!1);O(this,R,new Map);O(this,j,new Set);S(this,D,e),S(this,G,l)}get client(){return m(this,_)}async connect(){if(m(this,_))throw new Error("Already connected");S(this,_,await Y(window.PlayerIO.authenticate)(m(this,D),"public",{userId:"Guest"},{})),m(this,G)&&(m(this,_).multiplayer.developmentServer="localhost:8184"),this.emit("connected")}async joinRoom(e,l,f={}){if(!m(this,_))throw new Error("Not connected");if(m(this,R).has(e))throw new Error("Already joined");if(m(this,j).has(e))throw new Error("Already joining");const n=new fe(this,e,l);return m(this,j).add(e),n.on("joined",()=>{m(this,R).set(n.id,n),this.emit("joinedRoom",n)}),n.on("left",()=>{m(this,R).delete(n.id),this.emit("leftRoom",n)}),await n.join(f).finally(()=>{m(this,j).delete(e)}),n}}D=new WeakMap,_=new WeakMap,G=new WeakMap,R=new WeakMap,j=new WeakMap;const z=new URLSearchParams(location.search).get("name")??`Player${Math.floor(Math.random()*99e3+1e3)}`;let I,T;new oe({targetElement:document.body,swfUrl:"game.swf",swfParameters:{surl:"penis",sport:4444,sound:1,user:z,hash:"1bf6093ea530924697ca9cebd7bf4abb"},proxies:[{host:"penis",port:4444,async onConnect(c){const i=e=>{throw e&&c.send(`<errorMsg>${e}</errorMsg>\0`),c.close(),new Error(e)};(I||T)&&i("Already connected"),I=new ae("bomberpengu-b3s34ovekbapmidml5oq");try{if(!I)throw new Error("ERROR");await I.connect(),T=await I.joinRoom("lobby","Lobby",{joinData:{name:z}})}catch{i("Connecting failed!")}T.on("xml",e=>{e=e.replace(/\0*$/,"\0").replace(/(<[ \t/]*)Tag(\d)/g,"$1$2"),e=e.replace(/\n\0$/g,"\0"),c.send(e)}),T.on("left",()=>{i("Disconnected")})},onDisconnect(c){},async onMessage(c,i){const e=new TextDecoder().decode(i).replace(/\0*$/,"").replace(/(<[ \t/]*)(\d)/g,"$1Tag$2");/<beat\//.test(e)||T==null||T.sendXml(e)}}]});
