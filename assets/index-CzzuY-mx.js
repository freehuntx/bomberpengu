var ne=Object.defineProperty;var V=c=>{throw TypeError(c)};var re=(c,o,e)=>o in c?ne(c,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[o]=e;var u=(c,o,e)=>re(c,typeof o!="symbol"?o+"":o,e),W=(c,o,e)=>o.has(c)||V("Cannot "+e);var v=(c,o,e)=>(W(c,o,"read from private field"),e?e.call(c):o.get(c)),O=(c,o,e)=>o.has(c)?V("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(c):o.set(c,e),S=(c,o,e,i)=>(W(c,o,"write to private field"),i?i.call(c,e):o.set(c,e),e);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))i(f);new MutationObserver(f=>{for(const n of f)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function e(f){const n={};return f.integrity&&(n.integrity=f.integrity),f.referrerPolicy&&(n.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?n.credentials="include":f.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(f){if(f.ep)return;f.ep=!0;const n=e(f);fetch(f.href,n)}})();var G={exports:{}},X;function se(){if(X)return G.exports;X=1;var c=typeof Reflect=="object"?Reflect:null,o=c&&typeof c.apply=="function"?c.apply:function(t,s,a){return Function.prototype.apply.call(t,s,a)},e;c&&typeof c.ownKeys=="function"?e=c.ownKeys:Object.getOwnPropertySymbols?e=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:e=function(t){return Object.getOwnPropertyNames(t)};function i(r){console&&console.warn&&console.warn(r)}var f=Number.isNaN||function(t){return t!==t};function n(){n.init.call(this)}G.exports=n,G.exports.once=k,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var p=10;function C(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(r){if(typeof r!="number"||r<0||f(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");p=r}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||f(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function h(r){return r._maxListeners===void 0?n.defaultMaxListeners:r._maxListeners}n.prototype.getMaxListeners=function(){return h(this)},n.prototype.emit=function(t){for(var s=[],a=1;a<arguments.length;a++)s.push(arguments[a]);var l=t==="error",m=this._events;if(m!==void 0)l=l&&m.error===void 0;else if(!l)return!1;if(l){var d;if(s.length>0&&(d=s[0]),d instanceof Error)throw d;var L=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw L.context=d,L}var M=m[t];if(M===void 0)return!1;if(typeof M=="function")o(M,this,s);else for(var J=M.length,te=q(M,J),a=0;a<J;++a)o(te[a],this,s);return!0};function E(r,t,s,a){var l,m,d;if(C(s),m=r._events,m===void 0?(m=r._events=Object.create(null),r._eventsCount=0):(m.newListener!==void 0&&(r.emit("newListener",t,s.listener?s.listener:s),m=r._events),d=m[t]),d===void 0)d=m[t]=s,++r._eventsCount;else if(typeof d=="function"?d=m[t]=a?[s,d]:[d,s]:a?d.unshift(s):d.push(s),l=h(r),l>0&&d.length>l&&!d.warned){d.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=r,L.type=t,L.count=d.length,i(L)}return r}n.prototype.addListener=function(t,s){return E(this,t,s,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(t,s){return E(this,t,s,!0)};function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(r,t,s){var a={fired:!1,wrapFn:void 0,target:r,type:t,listener:s},l=N.bind(a);return l.listener=s,a.wrapFn=l,l}n.prototype.once=function(t,s){return C(s),this.on(t,y(this,t,s)),this},n.prototype.prependOnceListener=function(t,s){return C(s),this.prependListener(t,y(this,t,s)),this},n.prototype.removeListener=function(t,s){var a,l,m,d,L;if(C(s),l=this._events,l===void 0)return this;if(a=l[t],a===void 0)return this;if(a===s||a.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete l[t],l.removeListener&&this.emit("removeListener",t,a.listener||s));else if(typeof a!="function"){for(m=-1,d=a.length-1;d>=0;d--)if(a[d]===s||a[d].listener===s){L=a[d].listener,m=d;break}if(m<0)return this;m===0?a.shift():Z(a,m),a.length===1&&(l[t]=a[0]),l.removeListener!==void 0&&this.emit("removeListener",t,L||s)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(t){var s,a,l;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[t]),this;if(arguments.length===0){var m=Object.keys(a),d;for(l=0;l<m.length;++l)d=m[l],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=a[t],typeof s=="function")this.removeListener(t,s);else if(s!==void 0)for(l=s.length-1;l>=0;l--)this.removeListener(t,s[l]);return this};function g(r,t,s){var a=r._events;if(a===void 0)return[];var l=a[t];return l===void 0?[]:typeof l=="function"?s?[l.listener||l]:[l]:s?H(l):q(l,l.length)}n.prototype.listeners=function(t){return g(this,t,!0)},n.prototype.rawListeners=function(t){return g(this,t,!1)},n.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):K.call(r,t)},n.prototype.listenerCount=K;function K(r){var t=this._events;if(t!==void 0){var s=t[r];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};function q(r,t){for(var s=new Array(t),a=0;a<t;++a)s[a]=r[a];return s}function Z(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function H(r){for(var t=new Array(r.length),s=0;s<t.length;++s)t[s]=r[s].listener||r[s];return t}function k(r,t){return new Promise(function(s,a){function l(d){r.removeListener(t,m),a(d)}function m(){typeof r.removeListener=="function"&&r.removeListener("error",l),s([].slice.call(arguments))}B(r,t,m,{once:!0}),t!=="error"&&ee(r,l,{once:!0})})}function ee(r,t,s){typeof r.on=="function"&&B(r,"error",t,s)}function B(r,t,s,a){if(typeof r.on=="function")a.once?r.once(t,s):r.on(t,s);else if(typeof r.addEventListener=="function")r.addEventListener(t,function l(m){a.once&&r.removeEventListener(t,l),s(m)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}return G.exports}var F=se();const w=class w extends F.EventEmitter{constructor(e,i=[]){super();u(this,"CONNECTING",0);u(this,"OPEN",1);u(this,"CLOSING",2);u(this,"CLOSED",3);u(this,"bufferedAmount",0);u(this,"binaryType","arraybuffer");u(this,"protocol","");u(this,"readyState",w.CONNECTING);u(this,"url","");u(this,"extensions",{});u(this,"isPaused",!1);u(this,"_ping",0);u(this,"_events",new EventTarget);u(this,"onopen",null);u(this,"onmessage",null);u(this,"onerror",null);u(this,"onclose",null);this.url=typeof e=="string"?e:e.href,this.protocol=typeof i=="string"?i:i.join(","),this.on("open",()=>{var n;this.readyState=w.OPEN;const f=new Event("open");(n=this.onopen)==null||n.call(this,f),this.dispatchEvent(f)}),this.on("message",f=>{var p;const n=new MessageEvent("message",{data:f});(p=this.onmessage)==null||p.call(this,n),this.dispatchEvent(n)}),this.on("close",(f,n)=>{var C;this.readyState=w.CLOSED;const p=new CloseEvent("close",{code:f,reason:n});(C=this.onclose)==null||C.call(this,p),this.dispatchEvent(p)}),this.on("error",f=>{var p;const n=new ErrorEvent("error",{error:f});(p=this.onerror)==null||p.call(this,n),this.dispatchEvent(n)})}setPing(e){this._ping=e<0?0:e}send(e){this.binaryType==="arraybuffer"&&(typeof e=="string"?e=new TextEncoder().encode(e).buffer:ArrayBuffer.isView(e)&&(e=e.buffer)),setTimeout(()=>{this.emit("send",e)},this._ping/2)}pause(){if(this.readyState!==w.CONNECTING&&this.readyState!==w.CLOSED)throw new Error("pause not implemented")}ping(e,i,f){throw new Error("ping not implemented")}pong(e,i,f){throw new Error("pong not implemented")}resume(){if(this.readyState!==w.CONNECTING&&this.readyState!==w.CLOSED)throw new Error("resume not implemented")}close(e=1e3,i=""){this.readyState===w.OPEN&&(this.readyState=w.CLOSING),this.readyState!=w.CLOSED&&(this.readyState=w.CLOSED,setTimeout(()=>{this.emit("close",e,i)},this._ping/2))}terminate(){throw new Error("terminate not implemented")}addEventListener(e,i){this._events.addEventListener(e,i)}removeEventListener(e,i){this._events.removeEventListener(e,i)}dispatchEvent(e){return this._events.dispatchEvent(e)}};u(w,"CONNECTING",0),u(w,"OPEN",1),u(w,"CLOSING",2),u(w,"CLOSED",3);let U=w;class ie extends F.EventEmitter{constructor(e={}){super();u(this,"_host");u(this,"_port");u(this,"_ping");u(this,"_url");this._ping=e.ping??0,this._host=e.host??"0.0.0.0",this._port=e.port??(location.protocol==="https:"?443:80),this._url=e.url,this._hookWebSocket()}get ping(){return this._ping}address(){var e;return{family:((e=this._host)==null?void 0:e.indexOf(":"))!==-1?"IPv6":"IPv4",address:this._host,port:this._port}}_hookWebSocket(){const e=this,i=window.WebSocket,n=class n extends EventTarget{constructor(h,E=[]){super();u(this,"CONNECTING",0);u(this,"OPEN",1);u(this,"CLOSING",2);u(this,"CLOSED",3);u(this,"_binaryType","blob");u(this,"bufferedAmount",0);u(this,"protocol","");u(this,"readyState",0);u(this,"url","");u(this,"extensions","");u(this,"wsClient",null);u(this,"onopen",null);u(this,"onmessage",null);u(this,"onerror",null);u(this,"onclose",null);this.url=typeof h=="string"?h:h.href;let N=!1;if(e._url)N=new RegExp(e._url.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")).test(this.url);else{const y=e.address();N=this.url.indexOf(`://${y.address}:${y.port}`)!==-1}if(!N)return new i(h,E);this.readyState=n.CONNECTING,this.protocol=typeof E=="string"?E:E.join(","),this.wsClient=new U(h,E),this.wsClient.on("open",()=>{e.emit("connection",this.wsClient)}),this.wsClient.on("send",y=>{const g=new MessageEvent("message",{data:y});this.dispatchEvent(g)}),this.addEventListener("open",y=>{var g;(g=this.onopen)==null||g.call(this,y),setTimeout(()=>{this.wsClient.emit("open")},e.ping/2)}),this.addEventListener("message",y=>{var g;(g=this.onmessage)==null||g.call(this,y)}),this.addEventListener("close",y=>{var g;(g=this.onclose)==null||g.call(this,y),setTimeout(()=>{this.wsClient.emit("close")},e.ping/2)}),this.addEventListener("error",y=>{var g;(g=this.onerror)==null||g.call(this,y)}),setTimeout(()=>{this.readyState=n.OPEN,this.dispatchEvent(new Event("open"))},100)}get binaryType(){return this._binaryType}set binaryType(h){this._binaryType=h,h==="arraybuffer"&&(this.wsClient.binaryType=h)}close(){if(this.readyState===n.CLOSING||this.readyState===n.CLOSED)throw new Error("WebSocket is not open");this.readyState=n.CLOSING,this.readyState=n.CLOSED,this.dispatchEvent(new Event("close"))}send(h){if(this.readyState!==n.OPEN)throw new Error("WebSocket is not open");if(ArrayBuffer.isView(h)){const E=h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength);h=Reflect.construct(h.constructor,[E])}else h instanceof ArrayBuffer&&(h=h.slice(0));this.binaryType==="arraybuffer"&&(typeof h=="string"?h=new TextEncoder().encode(h).buffer:ArrayBuffer.isView(h)&&(h=h.buffer)),setTimeout(()=>{this.wsClient.emit("message",h)},e.ping/2)}};u(n,"CONNECTING",0),u(n,"OPEN",1),u(n,"CLOSING",2),u(n,"CLOSED",3);let f=n;window.WebSocket=f}}class oe{constructor(o){var n;const i=window.RufflePlayer.newest().createPlayer();o.targetElement.appendChild(i);const f={autoplay:"on",unmuteOverlay:"hidden",preloader:!1,splashScreen:!1,logLevel:"error",...o.ruffle,url:o.swfUrl,parameters:{...(n=o.ruffle)==null?void 0:n.parameters,...o.swfParameters},socketProxy:[]};for(const p of o.proxies||[])f.socketProxy.push({host:p.host,port:p.port,proxyUrl:`wss://${p.host}:${p.port}`}),new ie({host:p.host,port:p.port}).on("connection",h=>{var E;(E=p.onConnect)==null||E.call(p,h),h.on("message",N=>{var y;(y=p.onMessage)==null||y.call(p,h,N)}),h.on("close",(N,y)=>{var g;(g=p.onDisconnect)==null||g.call(p,h,N,y)})});console.log(f),i.load(f)}}class Q{constructor(){u(this,"emitter",new F.EventEmitter)}emit(o,...e){this.emitter.emit(o,...e)}on(o,e){this.emitter.on(o,e)}off(o,e){this.emitter.off(o,e)}}function Y(c){return(...o)=>new Promise((e,i)=>{c(...o,e,i)})}var T,b,x,j;class ae extends Q{constructor(e,i,f){super();O(this,T);O(this,b);O(this,x);O(this,j);S(this,T,e),S(this,x,i),S(this,j,f)}get id(){return v(this,x)}get roomType(){return v(this,j)}async sendEvent(e,...i){var f;(f=v(this,b))==null||f.send("event",JSON.stringify([e,...i]))}async sendXml(e){var i;(i=v(this,b))==null||i.send("xml",e)}async join(e={}){v(this,T).client.multiplayer.useSecureConnections=location.protocol==="https:",S(this,b,await Y(v(this,T).client.multiplayer.createJoinRoom)(v(this,x),v(this,j),!1,e.roomData||null,e.joinData||null)),v(this,b).addMessageCallback("event",i=>{const f=JSON.parse(i.getString(0));this.emit("event",...f)}),v(this,b).addMessageCallback("xml",i=>{this.emit("xml",i.getString(0))}),v(this,b).addDisconnectCallback(()=>{v(this,b)&&(S(this,b,null),this.emit("left"))}),this.emit("joined")}}T=new WeakMap,b=new WeakMap,x=new WeakMap,j=new WeakMap;var D,_,$,R,A;class fe extends Q{constructor(e,i=!1){super();O(this,D);O(this,_);O(this,$,!1);O(this,R,new Map);O(this,A,new Set);S(this,D,e),S(this,$,i)}get client(){return v(this,_)}async connect(){if(v(this,_))throw new Error("Already connected");S(this,_,await Y(window.PlayerIO.authenticate)(v(this,D),"public",{userId:"Guest"},{})),v(this,$)&&(v(this,_).multiplayer.developmentServer="localhost:8184"),this.emit("connected")}async joinRoom(e,i,f={}){if(!v(this,_))throw new Error("Not connected");if(v(this,R).has(e))throw new Error("Already joined");if(v(this,A).has(e))throw new Error("Already joining");const n=new ae(this,e,i);return v(this,A).add(e),n.on("joined",()=>{v(this,R).set(n.id,n),this.emit("joinedRoom",n)}),n.on("left",()=>{v(this,R).delete(n.id),this.emit("leftRoom",n)}),await n.join(f).finally(()=>{v(this,A).delete(e)}),n}}D=new WeakMap,_=new WeakMap,$=new WeakMap,R=new WeakMap,A=new WeakMap;const z=new URLSearchParams(location.search).get("name")??`Player${Math.floor(Math.random()*99e3+1e3)}`;let I,P;new oe({targetElement:document.body,swfUrl:"game.swf",swfParameters:{surl:"penis",sport:4444,sound:1,user:z,hash:"1bf6093ea530924697ca9cebd7bf4abb"},proxies:[{host:"penis",port:4444,async onConnect(c){const o=i=>{throw i&&c.send(`<errorMsg>${i}</errorMsg>\0`),c.close(),new Error(i)};(I||P)&&o("Already connected"),I=new fe("bomberpengu-b3s34ovekbapmidml5oq");try{if(!I)throw new Error("pio not found");await I.connect(),P=await I.joinRoom("lobby","Lobby",{joinData:{name:z}})}catch(i){console.error(i),o("Connecting failed!")}const e=new URLSearchParams(location.search).get("motd");if(e)if(e.split(":").length>1){const[i,f]=e.split(":");c.send(`<msgAll name="${i}" msg="${f}" />\0`)}else c.send(`<msgAll name="System" msg="${e}" />\0`);P.on("xml",i=>{i=i.replace(/\0*$/,"\0").replace(/(<[ \t/]*)Tag(\d)/g,"$1$2"),i=i.replace(/\n\0$/g,"\0"),c.send(i)}),P.on("left",()=>{o("Disconnected")})},onDisconnect(c){},async onMessage(c,o){const e=new TextDecoder().decode(o).replace(/\0*$/,"").replace(/(<[ \t/]*)(\d)/g,"$1Tag$2");/<beat\//.test(e)||P==null||P.sendXml(e)}}]});
